<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <title>预约我们</title>
    <link rel="stylesheet" href="${base}/mrhweb/jm/css/appoint.css">
    <script src="${base}/mrhweb/jm/js/jquery/modernizr.custom.63321.js"></script>
    <!--<script src="css/icon/iconfont.js"></script>-->
    <style>


    </style>
</head>
<body>
<#include "../template/nav.html"/>

<div class="container addr">
    <p>你所在位置：<a href="#">首页</a>&gt;&gt;<a href="#">预约我们</a></p>
    <hr>
</div>
<section class="appoint">
    <div class="container">
        <div class="row">
            <div class="col-sm-6 col-sm-offset-3">
                <div class="form-box shadow-c one-color">
                    <form id="msgForm" class="form" method="post" action="http://127.0.0.1:8089/jm/message/save.json" onsubmit="doSave(this);">
                        <div class="form-inline form-group">
                            <div class="form-group msg">
                                <label for="">姓：</label>
                                <input name="name" type="text" class="name-in one-color">
                                <span class="hidden" id="msgName">请输入正确的字符</span>
                            </div>
                            <div id="dd" class="form-group wrapper-dropdown-1 one-bg-color msg" tabindex="1">
                                <span>称呼：</span>
                                <input id="gender" type="hidden" name="gender">
                                <ul class="dropdown" tabindex="1">
                                    <li data-id="0"><a href="#">先生</a>
                                    </li>
                                    <li data-id="1"><a href="#">女士</a>
                                    </li>
                                </ul>
                                <span class="hidden" id="msgGender">请选择称呼</span>
                            </div>
                        </div>
                        <div class="form-group msg">
                            <label for="">联系电话：</label>
                            <input type="text" name="phone" class="one-color"
                                   onkeyup="this.value=this.value.replace(/\D/g,'')" onafterpaste="this.value=this.value.replace(/\D/g,'')"
                            >
                            <span class="hidden" id="msgPhone">请输入13位手机号码</span>
                        </div>
                        <div class="form-group msg">
                            <label for="">预约时间：</label>
                            <input type="text" name="appointTime" class="one-color"
                                   onclick="WdatePicker({el:this,dateFmt:'yyyy-MM-dd HH:mm:ss' ,minDate : curentTime()})"
                                   onfocus="WdatePicker({el:this,dateFmt:'yyyy-MM-dd HH:mm:ss' ,minDate : curentTime()})"
                            >
                            <span class="hidden" id="msgAppoint">请选择预约时间</span>
                        </div>
                        <div class="form-inline form-group msg">
                            <label for="">预约问题：</label>
                            <div class="select-box">
                                <select id="cd-dropdown" name="adviceType" class="cd-select">
                                    <option value="-1"  selected>请选择</option>
                                    <option value="1" class="icon-select icon-iconda">我要装修</option>
                                    <option value="2" class="icon-select icon-jiageprice">价格咨询</option>
                                    <option value="3" class="icon-select icon-kefu">售后服务</option>
                                    <option value="4" class="icon-select icon-zixunfuwu">其他咨询</option>
                                    <option value="5" class="icon-select icon-tousu1">我要投诉</option>
                                </select>
                            </div>
                            <span class="hidden" id="msgType">请选择预约问题</span>
                        </div>

                        <div class="form-group">
                            <label for="">详细：</label>
                        </div>
                        <textarea rows="3" class="one-color" name="detail"></textarea>
                        <div class="form-group text-center">
                            <div class="form-submit ">
                                <input type="submit" class="one-bg-color" value="预约">
                            </div>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
</section>
<section class="code-box">
    <div class="container">
        <div class="row">
            <div class="col-sm-6 col-sm-offset-3">
                <div class="contact shadow-c">
                    <p class="title">您也可以添加店长个人微信，<strong>任何问题</strong>可以得到更快的回答哦～</p>
                    <div class="row">
                        <div class="col-sm-4">
                            <div class="code text-center">
                            <div class="img"><img class="img-responsive" src="${base}/mrhweb/jm/img/index/QRcode.jpeg" alt=""></div>
                            <p>店长个人微信</p>
                            </div>
                        </div>
                        <div class="col-sm-4">
                            <div class="code text-center">
                                <div class="img"><img class="img-responsive" src="${base}/mrhweb/jm/img/index/QRcode.jpeg" alt=""></div>
                                <p>运营经理个人微信</p>
                            </div>
                        </div>
                        <div class="col-sm-4">
                            <div class="code text-center">
                                <div class="img"><img class="img-responsive" src="${base}/mrhweb/jm/img/index/QRcode.jpeg" alt=""></div>
                                <p>境美硅藻泥漳州旗舰店公众号</p>
                            </div>
                        </div>
                    </div>



                </div>
            </div>
        </div>
    </div>
</section>
<#include "../template/foot.html"/>

<script src="${base}/mrhweb/jm/js/jquery/jquery.dropdown.js"></script>
<script>
    $( '#cd-dropdown' ).dropdown( {
        gutter : 5,
        delay : 100,
        random : true
    } );
</script>
<script src="${base}/mrhweb/jm/js/My97DatePicker/WdatePicker.js"></script>
<script src="${base}/mrhweb/jm/js/menu.js"></script>
<script src="${base}/mrhweb/jm/js/appoint.js"></script>
<script>
//    console.log(new Date());

    function validate(){
        var flag = true;
        var $form = $('#msgForm');
        var nameV = $form.find('input[name=name]').val();
        var $msgN = $('#msgName');
        if($.trim(nameV) == ""){
            $msgN.removeClass('hidden');
            flag = false;
        }else{
            $msgN.addClass('hidden');
        }
        var genderV = $form.find('input[name=gender]').val();
        var $msgG = $('#msgGender');
        if(!genderV){
            $msgG.removeClass('hidden');
            flag = false;
        }else{
            $msgG.addClass('hidden');
        }
        var appointV = $form.find('input[name=appointTime]').val();
        var $msgA = $('#msgAppoint');
        if(!appointV){
            $msgA.removeClass('hidden');
            flag = false;
        }else{
            $msgA.addClass('hidden');
        }
        var phoneV = $form.find('input[name=phone]').val();
        var $msgP = $('#msgPhone');
        var p = /^1[34578]\d{9}$/;
        if(phoneV != "" && p.exec(phoneV)?false:true){
            $msgP.removeClass('hidden');
            flag = false;
        }else{
            $msgP.addClass('hidden');
        }
        var typeV = $form.find('select[name=adviceType]').val();
        var $msgT = $('#msgType');
        if(typeV == "-1"){
            $msgT.removeClass('hidden');
            flag = false;
        }else{
            $msgT.addClass('hidden');
        }

        return flag;
    }


    function doSave(form){
        if(validate()) {
            $.ajax({
                url: form.action,
                data: $(form).serialize(),
                type: "POST",
                success: function (data) {
                    if (data.result == true) {
                        alert("保存成功");
                    }
                },
                error: function () {

                }
            });
        }
        preventEvent(event);
    }

    function curentTime() {
        var now = new Date();
        var year = now.getFullYear();
        var month = now.getMonth() + 1;
        var day = now.getDate();
        var hh = now.getHours();
        var mm = now.getMinutes();
        var clock = year + "-";
        if (month < 10)
            clock += "0";
        clock += month + "-";
        if (day < 10)
            clock += "0";
        clock += day + " ";
        if (hh < 10)
            clock += "0";
        clock += hh + ":";
        if (mm < 10) clock += '0';
        clock += mm;
        return (clock);
    }

</script>
</body>
</html>